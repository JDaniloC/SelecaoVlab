<div class="movie-list-container">
  <div class="header">
    <h1>Buscar Filmes</h1>
    <p>Encontre filmes para adicionar Ã  sua maratona</p>
  </div>

  <app-filmography-search
    [loading]="(loading$ | async) ?? false"
    [selectedPersonName]="(selectedPerson$ | async)?.name ?? null"
    (search)="onFilmographySearch($event)"
    (clear)="onFilmographyClear()"
  ></app-filmography-search>

  <app-movie-filters
    [genres]="(genres$ | async) || []"
    (filterChange)="onFilterChange($event)">
  </app-movie-filters>

  <div class="movies-found">
    @if (selectedPerson$ | async; as person) {
      {{ (movies$ | async)?.length }} filmes encontrados na filmografia de <strong>{{ person.name }}</strong>
    } @else {
      {{ (movies$ | async)?.length }} filmes encontrados
    }
  </div>

  <div class="content-wrapper">
    <div class="movie-grid">
      @for (movie of (movies$ | async); track movie.id) {
        <app-movie-card [movie]="movie"></app-movie-card>
      }
    </div>
    <div class="marathon-section">
      <app-marathon-list></app-marathon-list>
    </div>
  </div>

  @if (loading$ | async) {
    <div class="loading-spinner">
      <p>Carregando filmes...</p>
    </div>
  }

  @if (error$ | async; as error) {
    <div class="error-message">
      <p>{{ error }}</p>
    </div>
  }

  @if ((movies$ | async)?.length === 0 && !(loading$ | async)) {
    <div class="no-results">
      @if (selectedPerson$ | async; as person) {
        <p>Nenhum filme encontrado na filmografia de {{ person.name }}.</p>
      } @else {
        <p>Nenhum filme encontrado. Tente ajustar os filtros.</p>
      }
    </div>
  }
</div>
